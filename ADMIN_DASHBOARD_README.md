# Admin Dashboard Documentation

## Overview
The Admin Dashboard is a specialized interface for monitoring and analyzing RAG (Retrieval-Augmented Generation) data generated by the EduGen AI system. It provides visibility into the AI-powered content generation process for both topics/subtopics and quizzes.

## Access
- **URL**: `/admin`
- **Authorization**: Only accessible to `yaknarashagan2@gmail.com`
- **Authentication**: Requires staff login

## Features

### 1. Topic & Subtopic Data View
Displays comprehensive information about AI-generated answers for topics posted by staff:

#### Data Displayed:
- **Date & Time**: When the task was posted
- **Topic**: Main topic name
- **Subtopic**: Subtopic name (if provided)
- **PDF Source**: Source document used for RAG extraction (or "General AI" if no PDF)
- **RAG Chunks**: Number of text chunks extracted from the document
- **RAG Extracted Context**: The actual text extracted from the PDF
- **AI Generated Answer**: The comprehensive 16-mark answer generated by AI
- **Metadata**: Staff ID, Task ID, Difficulty level, Question count

### 2. Quiz Data View
Displays comprehensive information about AI-generated quizzes:

#### Data Displayed:
- **Date & Time**: When the quiz was generated
- **Topic**: Main topic name
- **Subtopic**: Subtopic name (if provided)
- **PDF Source**: Source document used for RAG extraction
- **Questions**: Number of questions generated
- **Difficulty**: Easy, Medium, or Hard
- **RAG Extracted Context**: The actual text extracted from the PDF
- **Generated Quiz Questions**: All questions with options, correct answers, and explanations
- **Metadata**: Staff ID, Task ID, Cognitive level, RAG chunks

## Data Storage

### LocalStorage Structure
Data is stored in the browser's localStorage for quick access and persistence:

```javascript
// Topic Data
localStorage.getItem('admin_topic_data')
// Returns: Array of topic data objects

// Quiz Data
localStorage.getItem('admin_quiz_data')
// Returns: Array of quiz data objects
```

### Data Limits
- Maximum 100 entries per category (oldest entries are automatically removed)
- Data persists across browser sessions
- Data is specific to the browser/device

## How It Works

### Data Flow

1. **Staff Posts Task**:
   - Staff member creates a task with topic/subtopic
   - Optionally selects a PDF source for RAG
   - System generates AI answer

2. **RAG Processing**:
   - RAG API extracts relevant context from PDF
   - Context is sent to AI model (Groq)
   - AI generates comprehensive answer

3. **Admin Logging**:
   - `saveTopicDataToAdmin()` is called
   - Data is saved to localStorage
   - Includes: topic, subtopic, PDF source, RAG context, AI answer, metadata

4. **Quiz Generation** (similar flow):
   - Staff posts task with quiz parameters
   - RAG API extracts context for quiz generation
   - AI generates quiz questions
   - `saveQuizDataToAdmin()` saves data to localStorage

### Integration Points

#### StaffDashboard.js
```javascript
import { saveTopicDataToAdmin, saveQuizDataToAdmin } from "../utils/adminDataLogger";

// After RAG answer generation
saveTopicDataToAdmin({
  topic: taskTopic,
  subtopic: taskSubtopic || '',
  pdfSource: pdfToUse,
  ragContext: ragContext,
  aiAnswer: ragAnswer,
  ragChunksFound: ragChunksFound,
  staffId: user.uid,
  taskId: '',
  difficulty: taskDifficulty,
  questionCount: taskQuestions,
});

// After quiz generation
saveQuizDataToAdmin({
  topic: taskTopic,
  subtopic: taskSubtopic || '',
  pdfSource: pdfToUse || '',
  ragContext: quizRagContext,
  questions: quizData.questions,
  ragChunksFound: quizRagChunksFound,
  difficulty: taskDifficulty,
  cognitiveLevel: taskQuestionType,
  staffId: user.uid,
  taskId: '',
});
```

#### RAG API (rag_api.py)
```python
# Returns context in response
return jsonify({
    "success": True,
    "answer": answer_text,
    "sources": final_sources,
    "topic": topic,
    "subtopic": subtopic,
    "pdf_used": pdf_name,
    "chunks_found": len(results),
    "context": context_text  # For admin dashboard
}), 200
```

## UI Features

### Navigation
- **Two Tabs**: Topic & Subtopic Data | Quiz Data
- **Badge Counters**: Show number of entries in each category
- **Refresh Button**: Reload data from localStorage
- **Clear Data Button**: Remove all admin data (with confirmation)
- **Logout Button**: Sign out and return to login

### Data Display
- **Table Format**: Clean, organized table layout
- **Expandable Rows**: Click "View" to see detailed information
- **Color Coding**:
  - PDF sources: Red badge
  - General AI: Blue badge
  - Difficulty levels: Green (Easy), Orange (Medium), Red (Hard)
  - Correct answers: Green highlight

### Responsive Design
- Mobile-friendly layout
- Scrollable tables
- Adaptive grid for metadata
- Touch-friendly buttons

## Security

### Access Control
```javascript
// Check if user is authorized admin
if (user.email === 'yaknarashagan2@gmail.com') {
  setIsAuthorized(true);
  loadAdminData();
} else {
  alert('Access Denied: You are not authorized to view this page.');
  navigate('/staff-dashboard');
}
```

### Data Privacy
- Data is stored locally in the user's browser
- No sensitive student information is logged
- Only RAG processing data and AI outputs are stored
- Staff ID is logged for audit purposes

## Maintenance

### Clearing Data
Users can clear all admin data using the "Clear Data" button in the header. This will:
1. Show a confirmation dialog
2. Remove all data from localStorage
3. Reset the display to empty state

### Data Limits
The system automatically maintains data limits:
- Keeps only the 100 most recent entries per category
- Older entries are automatically removed when limit is reached
- Prevents localStorage quota issues

## Troubleshooting

### No Data Showing
1. Ensure you're logged in as `yaknarashagan2@gmail.com`
2. Check if staff has posted any tasks with RAG enabled
3. Verify localStorage is not disabled in browser
4. Try clicking "Refresh" button

### Data Not Updating
1. Check browser console for errors
2. Verify RAG API is running (port 5000)
3. Verify quiz backend is running (port 10000)
4. Check network tab for API responses

### Access Denied
1. Verify you're using the correct email address
2. Ensure you're logged in as staff, not student
3. Try logging out and logging back in

## Future Enhancements

Potential improvements for the admin dashboard:

1. **Export Functionality**: Download data as CSV/JSON
2. **Search & Filter**: Search by topic, date, or staff
3. **Analytics**: Charts showing RAG usage patterns
4. **Comparison View**: Compare different AI answers for same topic
5. **Supabase Integration**: Store data in database instead of localStorage
6. **Real-time Updates**: WebSocket connection for live data
7. **Performance Metrics**: Track RAG accuracy and response times

## Technical Stack

- **Frontend**: React.js
- **Styling**: Custom CSS with gradients and animations
- **Storage**: Browser localStorage
- **Authentication**: Firebase Auth
- **Data Logging**: Custom utility functions
- **Icons**: Font Awesome

## File Structure

```
src/
├── pages/
│   └── AdminDashboard.js          # Main admin dashboard component
├── styles/
│   └── AdminDashboard.css         # Styling for admin dashboard
├── utils/
│   └── adminDataLogger.js         # Data logging utility functions
└── App.js                          # Route configuration

rag model/
└── rag_api.py                      # Modified to return context

edugen-backend/
└── server.js                       # Modified to pass through context
```

## API Modifications

### RAG API Changes
Added `context` field to response:
- `/api/rag/generate-answer`: Returns extracted context
- `/api/rag/generate-quiz`: Returns extracted context and chunks

### Backend Changes
Modified `/api/quiz/generate` to pass through:
- `context`: RAG extracted text
- `chunks_found`: Number of chunks extracted

## Support

For issues or questions about the admin dashboard:
1. Check the browser console for errors
2. Verify all backend services are running
3. Review the data flow diagram above
4. Contact the development team

---

**Last Updated**: December 2025
**Version**: 1.0.0
**Maintainer**: EduGen AI Development Team
